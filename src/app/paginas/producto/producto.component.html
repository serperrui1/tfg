<!-- <app-navbar [cuant]=(cantidades)></app-navbar> -->
<div class="wrapper" *ngIf="producto">

    <div class="row">
        <div class="col-md-3 producto-izquierda">

            <div *ngFor="let imagen of producto.imagenes">

                <img src="{{direccionImagen + imagen}}" width="100%">
            </div>



        </div>
        <div class="col-md-5 producto-derecha">
            <h3 style="text-align: center;">{{producto.titulo}}</h3>
            <a routerLink="/escaparate/{{proveedorId}}">{{producto.proveedorNombre}} </a> <br>

            <div>
                <p class="precio-unidades">Precio por unidad: {{producto.precio}}â‚¬ </p>
                <p class="precio-unidades">Unidades mÃ­nimas: {{producto.unidadesMinimas}}</p>

                <br>

            </div>
            <p>
                {{producto.descripcion}}
            </p>



        </div>
        <div class="col-md-2 infoFinal">
            <div class="contenido-infoFinal">
                <strong style="color:red">{{producto.precio * cantidadProducto}}â‚¬</strong> con {{cantidadProducto}} unidades
                <div>
                    <strong style="color: green;">En stock</strong>
                    <form [formGroup]="productoForm">
                        <label for="cantidad"><a>Cantidad : </a></label>
                        <input type="number" min="{{producto.unidadesMinimas}}" max="{{producto.stock}}" step="1" id="cantidad" formControlName="cantidadProducto">

                    </form>
                </div>
                <a class="botones" (click)="alCarrito(producto)">
                    AÃ±adir al carrito
                </a>
                <br>
                <a class="botones" (click)="comprar(producto)">
                    Comprar
                </a>
                <!-- <br>
                <br> <strong>Â¿Quieres proponer una oferta?,</strong>
                <br> <strong>Â¿tienes dudas sobre el producto?, ...</strong>
                <br> -->
                <a class="botones" routerLink="/crear-chat/{{producto._id}}">
                    Contacta con el proveedor
                </a>
                <div class="garantia">
                    <a routerLink="/garantia" class="text-primary m-l-5"> Ver la garantÃ­a de los productos</a>
                </div>
                <br>
                <a *ngIf="flag" class="btn btn-success boton-carrito" routerLink="/devolver-reclamar/{{pedidoId}}">
                    Solicitar devoluciÃ³n/reclamaciÃ³n
                </a>


            </div>
        </div>
    </div>
    <br>
    <div class="col-md-3 producto-izquierda">
        <h4>Detalles tÃ©cnicos</h4>
        <table class="table table-bordered">
            <tr *ngFor="let datos of producto.datosTecnicos">
                <td>{{datos.datosTecnicosTitulo}}</td>
                <td>{{datos.datosTecnicosDescripcion}}</td>
            </tr>
        </table>
    </div>
    <button type="submit" class="btn btn-success btn-block waves-effect waves-light m-r-10" *ngIf="prov" (click)="goEditIfProveedor();"><i class="fa fa-save"></i> Actualizar producto</button>
    <br>

    <div class="row">
        <div class="col-md-6 titulo-valorar">

            <h4 *ngIf="yaValorado"> Todas las valoraciones </h4>
            <h4 *ngIf="!yaValorado"> Valoraciones </h4>


            <div class="alert alert-success" *ngFor="let item of producto.valoraciones; let i = index">
                <ngb-rating [max]="5" [(rate)]="item.puntuacion" [readonly]="true"></ngb-rating>
                <p>Publicado por: {{this.nombres[i]}}</p>
                <p> {{item.comentario}}</p>

            </div>

        </div>

        <div class="col-md-6" *ngIf="flag && !yaValorado">
            <h5>Valorar el producto</h5>
            <form class="form p-t-20" autocomplete="off" [formGroup]="valoracionForm">
                <div class="form-group">
                    <label for="comentario">Comentario</label>
                    <div class="input-group">
                        <div class="input-group-addon"><i class="ti-user"></i></div>
                        <input type="text" class="form-control" id="comentario" formControlName="comentario">
                    </div>
                </div>
                <div class="form-group">
                    <label for="puntuacion">PuntuaciÃ³n</label>
                    <div class="input-group">
                        <ngb-rating [max]="5" [(rate)]="starRating" [resettable]="true" [readonly]="false" (hover)="isRating = true; hovered = $event" (leave)="isRating = false; hovered = 0" (rateChange)="getRating($event)"></ngb-rating>
                        <br>ðŸ‘‰ Si quiere puntuar con 0 estrellas, haga
                        <br>click sobre la Ãºltima estrella seleccionada
                    </div>
                </div>
            </form>
            <button type="submit" class="btn btn-success btn-block waves-effect waves-light m-r-10" [disabled]="valoracionForm.invalid" (click)="publicarValoracion()">
            <i class="fa fa-save"></i>
            Publicar valoraciÃ³n
        </button>
        </div>

        <div class="col-md-6 titulo-valorar" *ngIf="yaValorado">
            <h4> Mi valoraciÃ³n </h4>


            <div class="alert alert-success">
                <ngb-rating [max]="5" [(rate)]="miValoracion.puntuacion" [readonly]="true"></ngb-rating>
                <p>Comentario:
                    <br> "{{miValoracion.comentario}}"
                </p>

                <td class="text-nowrap text-center">
                    <a class="cursor" data-toggle="tooltip" data-original-title="Borrar" (click)="borrarValoracion()">
                        <i class="fa fa-trash-o" style="font-size:24px;color:red"></i>
                    </a>
                </td>

            </div>

        </div>

    </div>


</div>